<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>星河皆是你</title>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Zhi+Mang+Xing&family=Noto+Serif+SC:wght@300;700&display=swap" rel="stylesheet">
    
    <style>
        /* === 全局重置 === */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            /* 深邃夜空背景 */
            background: radial-gradient(circle at center bottom, #1b2735 0%, #090a0f 100%);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Noto Serif SC', serif;
            color: white;
            position: relative;
        }

        /* === 核心画布 === */
        canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1;
        }

        /* === UI 层 (悬浮在画布之上) === */
        .ui-layer {
            position: absolute;
            z-index: 10;
            width: 100%;
            height: 100%;
            pointer-events: none; /* 鼠标穿透 */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: 4vh 0 8vh 0;
            text-shadow: 0 4px 10px rgba(0,0,0,0.8);
        }

        /* 顶部日期 */
        .header {
            text-align: center;
            /* [修复] 修正动画名称 */
            animation: fadeInDown 2s ease-out;
        }
        
        .date-text {
            font-size: 1.1rem;
            letter-spacing: 6px;
            color: #aab;
            margin-bottom: 10px;
        }

        .love-quote {
            font-family: 'Zhi Mang Xing', cursive;
            font-size: 1.8rem;
            background: linear-gradient(to right, #ffafbd, #ffc3a0);
            -webkit-background-clip: text;
            color: transparent;
            opacity: 0.9;
        }

        /* 中间名字 (左右护法) */
        .names-container {
            position: absolute;
            top: 45%;
            width: 90%;
            display: flex;
            justify-content: space-between;
            transform: translateY(-50%);
            padding: 0 5%;
        }

        .name-card {
            text-align: center;
        }

        .nickname {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 4rem; /* 超大书法字 */
            line-height: 1.2;
            white-space: nowrap;
        }

        .tag {
            font-size: 0.9rem;
            letter-spacing: 2px;
            opacity: 0.7;
            margin-top: 5px;
            border-top: 1px solid rgba(255,255,255,0.3);
            padding-top: 5px;
            display: inline-block;
        }

        /* 男主特效：星河蓝 */
        .boy {
            color: #a1c4fd;
            filter: drop-shadow(0 0 10px rgba(161, 196, 253, 0.8));
            animation: floatLeft 6s ease-in-out infinite;
        }

        /* 女主特效：霓虹粉 */
        .girl {
            color: #fbc2eb;
            filter: drop-shadow(0 0 10px rgba(251, 194, 235, 0.8));
            animation: floatRight 6s ease-in-out infinite;
        }

        /* 底部计时器 */
        .timer-box {
            text-align: center;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(4px);
            padding: 15px 40px;
            border-radius: 50px;
            border: 1px solid rgba(255,255,255,0.1);
            animation: fadeInUp 2s ease-out;
            margin-bottom: 50px; /* 给下方的小人留位置 */
        }

        .timer-digits {
            font-family: 'Noto Serif SC', serif;
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(to right, #fff, #e0c3fc);
            -webkit-background-clip: text;
            color: transparent;
        }

        .timer-label {
            font-size: 0.8rem;
            letter-spacing: 5px;
            margin-top: 5px;
            opacity: 0.6;
        }

        /* 动画定义 */
        @keyframes floatLeft { 0%,100% { transform: translateY(0) rotate(-2deg); } 50% { transform: translateY(-15px) rotate(2deg); } }
        @keyframes floatRight { 0%,100% { transform: translateY(0) rotate(2deg); } 50% { transform: translateY(-15px) rotate(-2deg); } }
        
        /* [修复] 修正 CSS 动画名空格问题 */
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* 移动端适配 */
        @media (max-width: 768px) {
            .names-container { 
                flex-direction: column; 
                height: 500px; 
                justify-content: space-between;
                align-items: center;
            }
            .nickname { font-size: 3rem; }
            .timer-digits { font-size: 1.5rem; }
            .love-quote { font-size: 1.4rem; }
        }
    </style>
</head>
<body>

    <canvas id="canvas"></canvas>

    <div class="ui-layer">
        <div class="header">
            <div class="date-text">THE STORY BEGAN ON 2025.08.06</div>
            <div class="love-quote">所爱隔山海，山海皆可平</div>
        </div>

        <div class="names-container">
            <div class="name-card boy">
                <div class="nickname">椰椰宝宝</div>
                <div class="tag">MY SUPER HERO</div>
            </div>
            <div class="name-card girl">
                <div class="nickname">远远宝宝</div>
                <div class="tag">MY SWEET HEART</div>
            </div>
        </div>

        <div class="timer-box">
            <div class="timer-digits" id="timer">00 : 00 : 00 : 00</div>
            <div class="timer-label">天 时 分 秒</div>
        </div>
    </div>

    <script>
        // ==========================================
        //         1. 计时器系统
        // ==========================================
        const START_DATE = new Date('2025-08-06T13:55:00').getTime();

        function updateTimer() {
            const now = new Date().getTime();
            const diff = now - START_DATE;

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            const d = String(days).padStart(2, '0');
            const h = String(hours).padStart(2, '0');
            const m = String(minutes).padStart(2, '0');
            const s = String(seconds).padStart(2, '0');

            document.getElementById('timer').innerText = `${d} : ${h} : ${m} : ${s}`;
        }
        setInterval(updateTimer, 1000);
        updateTimer();

        // ==========================================
        //         2. 绘图引擎 (Canvas)
        // ==========================================
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        let width, height;
        let particles = [];     // 爱心粒子
        let stars = [];         // 背景星星
        let lanterns = [];      // 孔明灯
        let meteors = [];       // 流星
        let tick = 0;           // 时间因子

        // 初始化
        function init() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            createStars();
            createHeart();
        }

        // [修复] 窗口调整大小时清空所有数组，防止内存泄漏
        window.addEventListener('resize', () => {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            
            particles = [];
            stars = [];
            lanterns = []; // [修复] 清空孔明灯
            meteors = [];  // [修复] 清空流星
            
            createStars();
            createHeart();
        });

        // --- 类定义 ---

        // 1. 背景星星 (修复了 Alpha 跳变问题)
        class Star {
            constructor() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.size = Math.random() * 2;
                this.blinkSpeed = Math.random() * 0.05;
                this.alpha = Math.random();
            }
            draw() {
                this.alpha += this.blinkSpeed;
                
                // [修复] 钳制 alpha 值范围，防止视觉跳跃
                if (this.alpha > 1 || this.alpha < 0) {
                    this.blinkSpeed *= -1;
                    this.alpha = Math.max(0, Math.min(1, this.alpha));
                }

                ctx.fillStyle = `rgba(255,255,255,${this.alpha})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // 2. 爱心粒子
        class Particle {
            constructor() {
                this.reset();
            }
            reset() {
                // 心形公式
                let t = Math.random() * Math.PI * 2;
                let x = 16 * Math.pow(Math.sin(t), 3);
                let y = -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
                
                // 放大与散布
                let scale = 15; 
                this.ox = x * scale;
                this.oy = y * scale;
                
                // 3D 深度散布
                this.z = (Math.random() - 0.5) * 50;
                
                // 颜色 (提高亮度，防止太暗)
                this.color = Math.random() > 0.5 ? 
                    `rgba(161, 196, 253, ${0.7 + Math.random()*0.3})` : // 蓝，更亮
                    `rgba(251, 194, 235, ${0.7 + Math.random()*0.3})`; // 粉，更亮
                
                // 稍微加大粒子尺寸
                this.size = Math.random() * 2.5 + 1.5;
            }
            
            update(angle) {
                // 旋转公式
                let cos = Math.cos(angle);
                let sin = Math.sin(angle);
                
                // 绕Y轴旋转
                let x = this.ox * cos - this.z * sin;
                let z = this.ox * sin + this.z * cos;
                let y = this.oy;

                // 心跳效果
                let beat = 1 + Math.sin(tick * 0.05) * 0.05 * Math.pow(Math.sin(tick * 0.05), 2);
                x *= beat; y *= beat; z *= beat;

                // 透视投影
                let fov = 400;
                let perspective = fov / (fov + z);
                
                this.px = x * perspective + width / 2;
                this.py = y * perspective + height / 2 - 30; // 稍微向上提一点
                this.ps = this.size * perspective;
            }
            
            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.px, this.py, this.ps, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // 3. 孔明灯
        class Lantern {
            constructor() {
                this.x = Math.random() * width;
                this.y = height + Math.random() * 100;
                this.speed = Math.random() * 0.5 + 0.2;
                this.size = Math.random() * 10 + 10;
                this.wobble = Math.random() * Math.PI * 2;
            }
            update() {
                this.y -= this.speed;
                this.x += Math.sin(this.wobble) * 0.5;
                this.wobble += 0.02;
                if (this.y < -50) { // 飞出屏幕重置
                    this.y = height + 50;
                    this.x = Math.random() * width;
                }
            }
            draw() {
                // 灯身
                let g = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size);
                g.addColorStop(0, 'rgba(255, 180, 50, 0.8)'); // 核心亮橙色
                g.addColorStop(0.4, 'rgba(255, 100, 50, 0.4)');
                g.addColorStop(1, 'rgba(255, 50, 0, 0)');
                
                ctx.fillStyle = g;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // 4. 流星
        class Meteor {
            constructor() {
                this.reset();
            }
            reset() {
                this.x = Math.random() * width + width; // 从右侧开始
                this.y = Math.random() * height/2;
                this.speed = Math.random() * 10 + 5;
                this.len = Math.random() * 100 + 50;
                this.opacity = 0;
                this.state = 0; // 0:waiting, 1:falling
                this.wait = Math.random() * 200;
            }
            update() {
                if (this.state === 0) {
                    this.wait--;
                    if (this.wait <= 0) {
                        this.state = 1;
                        this.opacity = 1;
                    }
                } else {
                    this.x -= this.speed;
                    this.y += this.speed * 0.5;
                    this.opacity -= 0.01;
                    if (this.opacity <= 0) this.reset();
                }
            }
            draw() {
                if (this.state === 0) return;
                ctx.strokeStyle = `rgba(255,255,255,${this.opacity})`;
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(this.x + this.len, this.y - this.len * 0.5);
                ctx.stroke();
            }
        }

        // --- 批量创建 ---
        function createStars() {
            for(let i=0; i<150; i++) stars.push(new Star());
            for(let i=0; i<15; i++) lanterns.push(new Lantern());
            for(let i=0; i<3; i++) meteors.push(new Meteor());
        }
        function createHeart() {
            for(let i=0; i<800; i++) particles.push(new Particle());
        }

        // --- 绘制情侣剪影 (Canvas 画图) ---
        function drawCouple() {
            // 设置坐标到底部中心
            let cx = width / 2;
            let cy = height - 50; // 稍微靠上一点

            // 画一个小山坡
            ctx.fillStyle = '#05070a'; // 深色剪影
            ctx.beginPath();
            ctx.ellipse(cx, height, width/1.5, 100, 0, 0, Math.PI * 2);
            ctx.fill();

            // 两个小人的剪影
            ctx.fillStyle = '#111';
            
            // 男生 (左)
            ctx.beginPath();
            ctx.arc(cx - 25, cy - 40, 12, 0, Math.PI*2); // 头
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(cx - 25, cy - 28);
            ctx.lineTo(cx - 40, cy + 10); // 背
            ctx.lineTo(cx - 10, cy + 10); // 腿
            ctx.lineTo(cx - 15, cy - 28);
            ctx.fill();

            // 女生 (右, 靠着男生)
            ctx.beginPath();
            ctx.arc(cx + 15, cy - 35, 11, 0, Math.PI*2); // 头
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(cx + 15, cy - 24);
            ctx.lineTo(cx + 30, cy + 10); // 背
            ctx.lineTo(cx, cy + 10); // 腿
            ctx.lineTo(cx + 5, cy - 24);
            ctx.fill();

            // 两人手牵手的感觉
            ctx.beginPath();
            ctx.arc(cx - 5, cy + 5, 5, 0, Math.PI*2);
            ctx.fill();
        }

        // --- 主循环 ---
        function animate() {
            // [修复] 绝对重置坐标系，防止卡顿
            ctx.setTransform(1, 0, 0, 1, 0, 0); 
            
            // 清空画布 (减少了透明度，让爱心更亮，解决看不清的问题)
            ctx.fillStyle = 'rgba(10, 15, 25, 0.1)'; 
            ctx.fillRect(0, 0, width, height);

            tick++;

            // 1. 画背景星星
            stars.forEach(s => s.draw());

            // 2. 画流星
            meteors.forEach(m => { m.update(); m.draw(); });

            // 3. 画孔明灯 (在爱心后面)
            lanterns.forEach(l => { l.update(); l.draw(); });

            // 4. 画爱心
            let angle = tick * 0.003; // 旋转角度
            particles.forEach(p => {
                p.update(angle);
                p.draw();
            });

            // 5. 画情侣剪影 (永远在最前)
            drawCouple();

            requestAnimationFrame(animate);
        }

        init();
        animate();

    </script>
</body>
</html>
