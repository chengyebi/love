<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>星河长明</title>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Zhi+Mang+Xing&family=Noto+Serif+SC:wght@300;700&display=swap" rel="stylesheet">
    
    <style>
        /* === 全局重置 === */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            /* 更深邃的午夜蓝背景 */
            background: radial-gradient(circle at center bottom, #121a2a 0%, #040508 100%);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Noto Serif SC', serif;
            color: white;
            position: relative;
        }

        /* === 核心画布 === */
        canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1;
        }

        /* === UI 层 === */
        .ui-layer {
            position: absolute;
            z-index: 10;
            width: 100%;
            height: 100%;
            pointer-events: none; /* 鼠标穿透 */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: 5vh 0 8vh 0;
            text-shadow: 0 4px 15px rgba(0,0,0,0.9); /* 更强的文字阴影 */
        }

        /* 顶部 Header */
        .header {
            text-align: center;
            animation: fadeInDown 2s ease-out;
        }
        
        .date-text {
            font-family: 'Noto Serif SC', serif;
            font-size: 1.1rem;
            letter-spacing: 8px;
            color: #b8c6db;
            margin-bottom: 15px;
            font-weight: 300;
        }

        .love-quote {
            font-family: 'Zhi Mang Xing', cursive; /* 书法体 */
            font-size: 2.2rem;
            /* 高级流光渐变 */
            background: linear-gradient(to right, #a1c4fd, #c2e9fb, #fbc2eb, #a1c4fd);
            background-size: 300%;
            -webkit-background-clip: text;
            color: transparent;
            animation: flowText 8s infinite linear;
        }

        /* 中间名字 (左右护法) */
        .names-container {
            position: absolute;
            top: 46%;
            width: 88%;
            display: flex;
            justify-content: space-between;
            transform: translateY(-50%);
        }

        .name-card { text-align: center; }

        .nickname {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 3.8rem;
            line-height: 1.1;
            white-space: nowrap;
        }

        .tag {
            font-family: 'Noto Serif SC', serif;
            font-size: 1rem;
            letter-spacing: 3px;
            opacity: 0.8;
            margin-top: 12px;
            border-top: 1px solid rgba(255,255,255,0.2);
            padding-top: 8px;
            display: inline-block;
        }

        /* 男主特效：高饱和青蓝 */
        .boy {
            color: #89f7fe;
            text-shadow: 0 0 20px rgba(137, 247, 254, 0.8);
            animation: floatLeft 7s ease-in-out infinite;
        }

        /* 女主特效：高饱和紫粉 */
        .girl {
            color: #f6a6ff;
            text-shadow: 0 0 20px rgba(246, 166, 255, 0.8);
            animation: floatRight 7s ease-in-out infinite;
        }

        /* 底部计时器 */
        .timer-box {
            text-align: center;
            animation: fadeInUp 2s ease-out;
            margin-bottom: 50px;
        }

        .timer-digits {
            font-family: 'Noto Serif SC', serif;
            font-size: 2.4rem;
            font-weight: 700;
            letter-spacing: 2px;
            /* 珍珠白渐变 */
            background: linear-gradient(to bottom, #ffffff, #dbe6f6);
            -webkit-background-clip: text;
            color: transparent;
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.3));
        }

        .timer-label {
            font-size: 0.9rem;
            letter-spacing: 15px;
            margin-top: 8px;
            opacity: 0.6;
            padding-left: 15px; /* 视觉平衡 */
        }

        /* 动画定义 */
        @keyframes floatLeft { 0%,100% { transform: translateY(0) rotate(-1deg); } 50% { transform: translateY(-12px) rotate(1deg); } }
        @keyframes floatRight { 0%,100% { transform: translateY(0) rotate(1deg); } 50% { transform: translateY(-12px) rotate(-1deg); } }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes flowText { 0% { background-position: 0%; } 100% { background-position: 300%; } }

        /* 移动端适配 */
        @media (max-width: 768px) {
            .names-container { 
                flex-direction: column; 
                height: 480px; 
                justify-content: space-between;
                align-items: center;
                top: 50%;
            }
            .nickname { font-size: 3.2rem; }
            .timer-digits { font-size: 1.8rem; }
            .love-quote { font-size: 1.6rem; }
            .date-text { font-size: 1rem; letter-spacing: 4px; }
        }
    </style>
</head>
<body>

    <canvas id="canvas"></canvas>

    <div class="ui-layer">
        <div class="header">
            <div class="date-text">初见于 二〇二五年八月六日</div>
            <div class="love-quote">海底月是天上月，眼前人是心上人。</div>
        </div>

        <div class="names-container">
            <div class="name-card boy">
                <div class="nickname">椰椰宝宝</div>
                <div class="tag">既见君子，云胡不喜</div>
            </div>
            <div class="name-card girl">
                <div class="nickname">远远宝宝</div>
                <div class="tag">有一人兮，见之不忘</div>
            </div>
        </div>

        <div class="timer-box">
            <div class="timer-digits" id="timer">00 : 00 : 00 : 00</div>
            <div class="timer-label">天 时 分 秒</div>
        </div>
    </div>

    <script>
        // ==========================================
        //         1. 计时器系统
        // ==========================================
        const START_DATE = new Date('2025-08-06T13:55:00').getTime();

        function updateTimer() {
            const now = new Date().getTime();
            const diff = now - START_DATE;

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            const d = String(days).padStart(2, '0');
            const h = String(hours).padStart(2, '0');
            const m = String(minutes).padStart(2, '0');
            const s = String(seconds).padStart(2, '0');

            // 使用全角冒号，视觉更平衡
            document.getElementById('timer').innerText = `${d} ： ${h} ： ${m} ： ${s}`;
        }
        setInterval(updateTimer, 1000);
        updateTimer();

        // ==========================================
        //         2. 绘图引擎 (Canvas)
        // ==========================================
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        let width, height;
        // 对象数组
        let particles = []; // 爱心
        let stars = [];     // 背景星
        let lanterns = [];  // 孔明灯
        let meteors = [];   // 流星
        let embers = [];    // [新增] 星烬浮尘
        let tick = 0;

        // 配置
        const HEART_PARTICLE_COUNT = 1600; // [升级] 粒子数量翻倍，更密集
        const HEART_SIZE = 15;

        function init() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            createElements();
        }

        window.addEventListener('resize', () => {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            // 清空所有数组防止内存泄漏
            particles = []; stars = []; lanterns = []; meteors = []; embers = [];
            createElements();
        });

        // --- 类定义 ---

        // 1. 背景星星 (带 Alpha 钳制修复)
        class Star {
            constructor() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.size = Math.random() * 1.5;
                this.blinkSpeed = Math.random() * 0.03;
                this.alpha = Math.random();
            }
            draw() {
                this.alpha += this.blinkSpeed;
                if (this.alpha > 1 || this.alpha < 0) {
                    this.blinkSpeed *= -1;
                    this.alpha = Math.max(0, Math.min(1, this.alpha));
                }
                ctx.fillStyle = `rgba(255,255,255,${this.alpha})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // 2. [核心升级] 高饱和 3D 爱心粒子
        class Particle {
            constructor() {
                this.reset();
                // 初始随机Z轴分布，避免成片出现
                this.z = (Math.random() - 0.5) * 100;
            }
            reset() {
                let t = Math.random() * Math.PI * 2;
                // 心形公式
                let x = 16 * Math.pow(Math.sin(t), 3);
                let y = -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
                
                // 散布算法：让心形内部充实
                let scatter = 1 - Math.pow(Math.random(), 5); 

                this.ox = x * HEART_SIZE * scatter;
                this.oy = y * HEART_SIZE * scatter;
                this.oz = (Math.random() - 0.5) * 50; // Z轴厚度
                
                // [升级] 使用 HSL 高饱和颜色
                // 青色系 或 紫粉色系
                if (Math.random() > 0.5) {
                    // Hue: 180-220 (青蓝), Saturation: 100%, Lightness: 60%
                    this.colorHue = 180 + Math.random() * 40;
                } else {
                    // Hue: 300-340 (紫粉), Saturation: 100%, Lightness: 60%
                    this.colorHue = 300 + Math.random() * 40;
                }

                this.sizeBase = Math.random() * 2 + 1;
            }
            
            update(angle) {
                let cos = Math.cos(angle);
                let sin = Math.sin(angle);
                
                // 3D 旋转
                let x = this.ox * cos - this.oz * sin;
                let z = this.ox * sin + this.oz * cos;
                let y = this.oy;

                // 心跳：双重正弦波模拟真实搏动感
                let beat = 1 + (Math.sin(tick * 0.06) + Math.sin(tick * 0.06 * 3)) * 0.03;
                x *= beat; y *= beat; z *= beat;

                // 透视投影
                let fov = 400;
                let perspective = fov / (fov + z);
                
                this.px = x * perspective + width / 2;
                this.py = y * perspective + height / 2 - 30;
                this.ps = this.sizeBase * perspective;
                // 根据距离调整透明度，远处淡，近处亮
                this.alpha = Math.min(1, Math.max(0.3, perspective * 0.8)); 
            }
            
            draw() {
                // 使用 HSL 颜色绘制
                ctx.fillStyle = `hsla(${this.colorHue}, 100%, 60%, ${this.alpha})`;
                ctx.beginPath();
                ctx.arc(this.px, this.py, this.ps, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // 3. 孔明灯
        class Lantern {
            constructor() {
                this.x = Math.random() * width;
                this.y = height + Math.random() * 200;
                this.speed = Math.random() * 0.4 + 0.2;
                this.size = Math.random() * 15 + 10;
                this.wobble = Math.random() * Math.PI * 2;
            }
            update() {
                this.y -= this.speed;
                this.x += Math.sin(this.wobble) * 0.3;
                this.wobble += 0.02;
                if (this.y < -100) { this.y = height + 100; this.x = Math.random() * width; }
            }
            draw() {
                // 更暖的橙红色光晕
                let g = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size);
                g.addColorStop(0, 'rgba(255, 200, 80, 0.9)');
                g.addColorStop(0.4, 'rgba(255, 120, 50, 0.5)');
                g.addColorStop(1, 'rgba(255, 50, 0, 0)');
                ctx.fillStyle = g;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // 4. 流星
        class Meteor {
            constructor() { this.reset(); }
            reset() {
                this.x = Math.random() * width * 1.5; 
                this.y = -100;
                this.speed = Math.random() * 12 + 8;
                this.len = Math.random() * 150 + 80;
                this.angle = Math.PI / 4 + (Math.random()-0.5)*0.3;
                this.wait = Math.random() * 300;
                this.active = false;
            }
            update() {
                if (!this.active) {
                    this.wait--;
                    if (this.wait <= 0) this.active = true;
                } else {
                    this.x -= this.speed * Math.cos(this.angle);
                    this.y += this.speed * Math.sin(this.angle);
                    if (this.x < -200 || this.y > height + 200) this.reset();
                }
            }
            draw() {
                if (!this.active) return;
                // 流星渐变尾巴
                let g = ctx.createLinearGradient(this.x, this.y, this.x + this.len*Math.cos(this.angle), this.y - this.len*Math.sin(this.angle));
                g.addColorStop(0, 'rgba(255,255,255,1)');
                g.addColorStop(1, 'rgba(255,255,255,0)');
                ctx.strokeStyle = g;
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(this.x + this.len*Math.cos(this.angle), this.y - this.len*Math.sin(this.angle));
                ctx.stroke();
            }
        }

        // 5. [新增] 星烬浮尘 (增加环境层次感)
        class Ember {
            constructor() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.size = Math.random() * 1;
                this.speedY = Math.random() * 0.2 + 0.1; // 缓慢上升
                this.alpha = Math.random() * 0.5 + 0.2;
            }
            update() {
                this.y -= this.speedY;
                if (this.y < 0) this.y = height;
            }
            draw() {
                ctx.fillStyle = `rgba(255, 255, 255, ${this.alpha})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // --- 绘制剪影 ---
        function drawCouple() {
            let cx = width / 2;
            let cy = height - 50;
            // 山坡
            let g = ctx.createLinearGradient(0, height-150, 0, height);
            g.addColorStop(0, '#0a0c14');
            g.addColorStop(1, '#020305');
            ctx.fillStyle = g;
            ctx.beginPath();
            ctx.ellipse(cx, height+20, width/1.4, 140, 0, 0, Math.PI * 2);
            ctx.fill();

            // 人物剪影
            ctx.fillStyle = '#0c101a';
            // 男
            ctx.beginPath(); ctx.arc(cx-28, cy-42, 13, 0, Math.PI*2); ctx.fill();
            ctx.beginPath(); ctx.moveTo(cx-28, cy-30); ctx.lineTo(cx-45, cy+10); ctx.lineTo(cx-12, cy+10); ctx.lineTo(cx-15, cy-30); ctx.fill();
            // 女
            ctx.beginPath(); ctx.arc(cx+18, cy-38, 12, 0, Math.PI*2); ctx.fill();
            ctx.beginPath(); ctx.moveTo(cx+18, cy-26); ctx.lineTo(cx+35, cy+10); ctx.lineTo(cx+2, cy+10); ctx.lineTo(cx+8, cy-26); ctx.fill();
        }

        function createElements() {
            for(let i=0; i<150; i++) stars.push(new Star());
            for(let i=0; i<HEART_PARTICLE_COUNT; i++) particles.push(new Particle());
            for(let i=0; i<12; i++) lanterns.push(new Lantern());
            for(let i=0; i<4; i++) meteors.push(new Meteor());
            for(let i=0; i<100; i++) embers.push(new Ember()); // [新增]
        }

        // --- 主循环 ---
        function animate() {
            ctx.setTransform(1, 0, 0, 1, 0, 0); 
            
            // 清空画布 (拖尾更淡，背景更深)
            ctx.fillStyle = 'rgba(8, 12, 20, 0.15)';
            ctx.fillRect(0, 0, width, height);

            tick++;

            // 绘制环境元素 (普通模式)
            stars.forEach(s => s.draw());
            embers.forEach(e => { e.update(); e.draw(); }); // [新增]
            meteors.forEach(m => { m.update(); m.draw(); });
            lanterns.forEach(l => { l.update(); l.draw(); });

            // [核心升级] 绘制爱心 (开启高亮叠加模式!)
            // 这会让粒子重叠处发白光，立体感爆棚
            ctx.globalCompositeOperation = 'lighter';
            let angle = tick * 0.0025;
            particles.forEach(p => {
                p.update(angle);
                p.draw();
            });
            ctx.globalCompositeOperation = 'source-over'; // 恢复默认模式

            // 绘制剪影 (最上层)
            drawCouple();

            requestAnimationFrame(animate);
        }

        init();
        animate();

    </script>
</body>
</html>
